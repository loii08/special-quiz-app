{"ast":null,"code":"import React,{useState,useEffect}from'react';import{useParams,Link}from'react-router-dom';import QuoteCard from'../components/QuoteCard.js';import DateDetailsCard from'../components/DateDetailsCard.js';import ImageRewardCard from'../components/ImageRewardCard.js';import QuizModal from'../components/QuizModal.js';import MessageRewardCard from'../components/MessageRewardCard.js';import NotFoundPage from'./NotFoundPage.js';import{useTheme}from'../context/ThemeContext.js';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const SpecialMessage=_ref=>{let{message}=_ref;return/*#__PURE__*/_jsx(\"div\",{className:\"special-message\",children:message});};const specialOccasions=[{name:'anniversary',condition:(start,current)=>start.getMonth()===current.getMonth()&&start.getDate()===current.getDate(),message:\"ðŸŽ‰ Happy Anniversary! ðŸŽ‰\"},{name:'valentines',condition:(start,current)=>current.getMonth()===1&&current.getDate()===14,message:\"ðŸ’– Happy Valentine's Day! ðŸ’–\"},{name:'christmas',condition:(start,current)=>current.getMonth()===11&&current.getDate()===25,message:\"ðŸŽ„ Merry Christmas! ðŸŽ„\"}];const QuizPage=()=>{const{quizId}=useParams();const[quizData,setQuizData]=useState(null);const[loading,setLoading]=useState(true);const[error,setError]=useState(null);const[isDetailsVisible,setDetailsVisible]=useState(false);const[isQuizOpen,setQuizOpen]=useState(false);const[activeOccasion,setActiveOccasion]=useState(null);const{setSpecialTheme}=useTheme();useEffect(()=>{const fetchQuizData=async()=>{try{setLoading(true);const response=await fetch(\"\".concat(process.env.REACT_APP_API_URL,\"/api/quiz/\").concat(quizId));if(!response.ok){throw new Error('Quiz not found. Maybe the link is old or incorrect?');}const data=await response.json();setQuizData(data);}catch(err){setError(err.message);}finally{setLoading(false);}};fetchQuizData();},[quizId]);useEffect(()=>{if(quizData){const startDate=new Date(quizData.anniversaryDate);const currentDate=new Date();let foundOccasion=null;for(const occasion of specialOccasions){if(occasion.condition(startDate,currentDate)){foundOccasion=occasion;break;}}if(foundOccasion){setActiveOccasion(foundOccasion);setSpecialTheme(foundOccasion.name);}}return()=>setSpecialTheme(null);},[quizData,setSpecialTheme]);const handleQuizSuccess=()=>{setQuizOpen(false);setDetailsVisible(true);setTimeout(()=>setDetailsVisible(false),60000);};if(loading){return/*#__PURE__*/_jsx(\"div\",{className:\"main-wrapper\",children:/*#__PURE__*/_jsx(\"div\",{className:\"card\",children:/*#__PURE__*/_jsx(\"h1\",{children:\"Loading Quiz...\"})})});}if(error){return/*#__PURE__*/_jsx(NotFoundPage,{});}return/*#__PURE__*/_jsxs(\"div\",{className:\"main-wrapper\",children:[activeOccasion&&/*#__PURE__*/_jsx(SpecialMessage,{message:activeOccasion.message}),/*#__PURE__*/_jsx(QuoteCard,{unlockedReward:isDetailsVisible?quizData.reward:null}),isDetailsVisible&&/*#__PURE__*/_jsx(DateDetailsCard,{anniversaryDate:quizData.anniversaryDate}),!isDetailsVisible&&/*#__PURE__*/_jsxs(\"button\",{className:\"interactive-button\",onClick:()=>setQuizOpen(true),disabled:!quizData,children:[/*#__PURE__*/_jsx(\"svg\",{xmlns:\"http://www.w3.org/2000/svg\",width:\"18\",height:\"18\",viewBox:\"0 0 24 24\",fill:\"none\",stroke:\"currentColor\",strokeWidth:\"2\",strokeLinecap:\"round\",strokeLinejoin:\"round\",children:/*#__PURE__*/_jsx(\"path\",{d:\"M21 2l-2 2m-7.61 7.61a5.5 5.5 0 1 1-7.778 7.778 5.5 5.5 0 0 1 7.777-7.777zm0 0L15.5 7.5m0 0l3 3L22 7l-3-3m-3.5 3.5L19 4\"})}),quizData.title||\"Unlock Our Story\"]}),isQuizOpen&&quizData&&/*#__PURE__*/_jsx(QuizModal,{gameData:quizData,onSuccess:handleQuizSuccess,onClose:()=>setQuizOpen(false)})]});};export default QuizPage;","map":{"version":3,"names":["React","useState","useEffect","useParams","Link","QuoteCard","DateDetailsCard","ImageRewardCard","QuizModal","MessageRewardCard","NotFoundPage","useTheme","jsx","_jsx","jsxs","_jsxs","SpecialMessage","_ref","message","className","children","specialOccasions","name","condition","start","current","getMonth","getDate","QuizPage","quizId","quizData","setQuizData","loading","setLoading","error","setError","isDetailsVisible","setDetailsVisible","isQuizOpen","setQuizOpen","activeOccasion","setActiveOccasion","setSpecialTheme","fetchQuizData","response","fetch","concat","process","env","REACT_APP_API_URL","ok","Error","data","json","err","startDate","Date","anniversaryDate","currentDate","foundOccasion","occasion","handleQuizSuccess","setTimeout","unlockedReward","reward","onClick","disabled","xmlns","width","height","viewBox","fill","stroke","strokeWidth","strokeLinecap","strokeLinejoin","d","title","gameData","onSuccess","onClose"],"sources":["C:/Users/chanl/Documents/Kenneth/html/client/src/pages/QuizPage.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport { useParams, Link } from 'react-router-dom';\r\nimport QuoteCard from '../components/QuoteCard.js';\r\nimport DateDetailsCard from '../components/DateDetailsCard.js';\r\nimport ImageRewardCard from '../components/ImageRewardCard.js';\r\nimport QuizModal from '../components/QuizModal.js';\r\nimport MessageRewardCard from '../components/MessageRewardCard.js';\r\nimport NotFoundPage from './NotFoundPage.js';\r\nimport { useTheme } from '../context/ThemeContext.js';\r\n\r\nconst SpecialMessage = ({ message }) => (\r\n    <div className=\"special-message\">{message}</div>\r\n);\r\n\r\nconst specialOccasions = [\r\n    { name: 'anniversary', condition: (start, current) => start.getMonth() === current.getMonth() && start.getDate() === current.getDate(), message: \"ðŸŽ‰ Happy Anniversary! ðŸŽ‰\" },\r\n    { name: 'valentines', condition: (start, current) => current.getMonth() === 1 && current.getDate() === 14, message: \"ðŸ’– Happy Valentine's Day! ðŸ’–\" },\r\n    { name: 'christmas', condition: (start, current) => current.getMonth() === 11 && current.getDate() === 25, message: \"ðŸŽ„ Merry Christmas! ðŸŽ„\" },\r\n];\r\n\r\nconst QuizPage = () => {\r\n    const { quizId } = useParams();\r\n    const [quizData, setQuizData] = useState(null);\r\n    const [loading, setLoading] = useState(true);\r\n    const [error, setError] = useState(null);\r\n\r\n    const [isDetailsVisible, setDetailsVisible] = useState(false);\r\n    const [isQuizOpen, setQuizOpen] = useState(false);\r\n    const [activeOccasion, setActiveOccasion] = useState(null);\r\n    const { setSpecialTheme } = useTheme();\r\n\r\n    useEffect(() => {\r\n        const fetchQuizData = async () => {\r\n            try {\r\n                setLoading(true);\r\n                const response = await fetch(`${process.env.REACT_APP_API_URL}/api/quiz/${quizId}`);\r\n                if (!response.ok) {\r\n                    throw new Error('Quiz not found. Maybe the link is old or incorrect?');\r\n                }\r\n                const data = await response.json();\r\n                setQuizData(data);\r\n            } catch (err) {\r\n                setError(err.message);\r\n            } finally {\r\n                setLoading(false);\r\n            }\r\n        };\r\n\r\n        fetchQuizData();\r\n    }, [quizId]);\r\n\r\n    useEffect(() => {\r\n        if (quizData) {\r\n            const startDate = new Date(quizData.anniversaryDate);\r\n            const currentDate = new Date();\r\n            let foundOccasion = null;\r\n\r\n            for (const occasion of specialOccasions) {\r\n                if (occasion.condition(startDate, currentDate)) {\r\n                    foundOccasion = occasion;\r\n                    break;\r\n                }\r\n            }\r\n\r\n            if (foundOccasion) {\r\n                setActiveOccasion(foundOccasion);\r\n                setSpecialTheme(foundOccasion.name);\r\n            }\r\n        }\r\n\r\n        return () => setSpecialTheme(null);\r\n    }, [quizData, setSpecialTheme]);\r\n\r\n    const handleQuizSuccess = () => {\r\n        setQuizOpen(false);\r\n        setDetailsVisible(true);\r\n        setTimeout(() => setDetailsVisible(false), 60000);\r\n    };\r\n\r\n    if (loading) {\r\n        return <div className=\"main-wrapper\"><div className=\"card\"><h1>Loading Quiz...</h1></div></div>;\r\n    }\r\n\r\n    if (error) {\r\n        return <NotFoundPage />;\r\n    }\r\n\r\n    return (\r\n        <div className=\"main-wrapper\">\r\n            {activeOccasion && <SpecialMessage message={activeOccasion.message} />}\r\n            <QuoteCard unlockedReward={isDetailsVisible ? quizData.reward : null} />\r\n\r\n            {isDetailsVisible && <DateDetailsCard anniversaryDate={quizData.anniversaryDate} />}\r\n\r\n            {!isDetailsVisible && (\r\n                <button className=\"interactive-button\" onClick={() => setQuizOpen(true)} disabled={!quizData}>\r\n                    <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"18\" height=\"18\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\"><path d=\"M21 2l-2 2m-7.61 7.61a5.5 5.5 0 1 1-7.778 7.778 5.5 5.5 0 0 1 7.777-7.777zm0 0L15.5 7.5m0 0l3 3L22 7l-3-3m-3.5 3.5L19 4\"></path></svg>\r\n                    {quizData.title || \"Unlock Our Story\"}\r\n                </button>\r\n            )}\r\n\r\n            {isQuizOpen && quizData && (\r\n                <QuizModal\r\n                    gameData={quizData}\r\n                    onSuccess={handleQuizSuccess}\r\n                    onClose={() => setQuizOpen(false)}\r\n                />\r\n            )}\r\n\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default QuizPage;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}