{"ast":null,"code":"import _objectSpread from\"C:/Users/chanl/Documents/Kenneth/html/client/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState,useEffect}from'react';import{Link,useNavigate}from'react-router-dom';import{useAuth}from'../context/AuthContext';import ConfirmModal from'../components/ConfirmModal';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const ProfilePage=()=>{const[quizzes,setQuizzes]=useState([]);const[quizCount,setQuizCount]=useState(0);const[loading,setLoading]=useState(true);const[copyStatus,setCopyStatus]=useState({});const[showConfirmModal,setShowConfirmModal]=useState(false);const[quizToDelete,setQuizToDelete]=useState(null);const{token}=useAuth();const navigate=useNavigate();useEffect(()=>{const fetchQuizzes=async()=>{try{const response=await fetch(\"\".concat(process.env.REACT_APP_API_URL,\"/api/quiz/my-quizzes\"),{headers:{'x-auth-token':token}});if(!response.ok)throw new Error('Failed to fetch quizzes');const data=await response.json();setQuizzes(data.quizzes);setQuizCount(data.quizCount);}catch(error){console.error(error);}finally{setLoading(false);}};if(token){fetchQuizzes();}},[token]);const handleCopyLink=quizId=>{const url=\"\".concat(window.location.origin,\"/quiz/\").concat(quizId);navigator.clipboard.writeText(url).then(()=>{setCopyStatus({[quizId]:'Copied!'});setTimeout(()=>setCopyStatus(prev=>_objectSpread(_objectSpread({},prev),{},{[quizId]:undefined})),2000);});};const handleDeleteRequest=quizId=>{setQuizToDelete(quizId);setShowConfirmModal(true);};const confirmDelete=async()=>{if(!quizToDelete)return;try{const response=await fetch(\"\".concat(process.env.REACT_APP_API_URL,\"/api/quiz/\").concat(quizToDelete),{method:'DELETE',headers:{'x-auth-token':token}});if(!response.ok)throw new Error('Failed to delete quiz');// Refresh the list of quizzes\nsetQuizzes(prevQuizzes=>prevQuizzes.filter(q=>q._id!==quizToDelete));}catch(error){console.error(error);alert('Could not delete the quiz. Please try again.');}finally{setShowConfirmModal(false);setQuizToDelete(null);}};const cancelDelete=()=>{setShowConfirmModal(false);setQuizToDelete(null);};if(loading){return/*#__PURE__*/_jsx(\"div\",{className:\"main-wrapper\",children:/*#__PURE__*/_jsx(\"div\",{className:\"card\",children:/*#__PURE__*/_jsx(\"h1\",{children:\"Loading Your Quizzes...\"})})});}return/*#__PURE__*/_jsx(\"div\",{className:\"main-wrapper\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"card\",children:[showConfirmModal&&/*#__PURE__*/_jsx(ConfirmModal,{message:\"This quiz will be permanently deleted. This action cannot be undone.\",onConfirm:confirmDelete,onCancel:cancelDelete}),/*#__PURE__*/_jsxs(\"div\",{className:\"profile-header\",children:[/*#__PURE__*/_jsx(\"h1\",{children:\"My Quizzes\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"profile-actions-group\",children:[/*#__PURE__*/_jsx(Link,{to:\"/create\",className:\"primary-button\",children:\"Create New Quiz\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"quiz-counter\",children:[quizCount,\" / 3\"]})]})]}),quizzes.length>0?/*#__PURE__*/_jsx(\"ul\",{className:\"quiz-list\",children:quizzes.map(quiz=>/*#__PURE__*/_jsxs(\"li\",{className:\"quiz-list-item\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"quiz-info\",children:[/*#__PURE__*/_jsx(Link,{to:\"/quiz/\".concat(quiz.quizId),children:quiz.title}),/*#__PURE__*/_jsxs(\"span\",{className:\"quiz-date\",children:[\"Created on: \",new Date(quiz.createdAt).toLocaleDateString()]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"quiz-actions\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleCopyLink(quiz.quizId),className:\"action-btn copy-btn\",title:\"Copy Link\",children:copyStatus[quiz.quizId]||'Copy'}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>navigate(\"/edit/\".concat(quiz._id)),className:\"action-btn edit-btn\",title:\"Edit Quiz\",children:\"Edit\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleDeleteRequest(quiz._id),className:\"action-btn delete-btn\",title:\"Delete Quiz\",children:\"Delete\"})]})]},quiz._id))}):/*#__PURE__*/_jsx(\"p\",{className:\"no-quizzes-message\",children:\"You haven't created any quizzes yet.\"})]})});};export default ProfilePage;","map":{"version":3,"names":["React","useState","useEffect","Link","useNavigate","useAuth","ConfirmModal","jsx","_jsx","jsxs","_jsxs","ProfilePage","quizzes","setQuizzes","quizCount","setQuizCount","loading","setLoading","copyStatus","setCopyStatus","showConfirmModal","setShowConfirmModal","quizToDelete","setQuizToDelete","token","navigate","fetchQuizzes","response","fetch","concat","process","env","REACT_APP_API_URL","headers","ok","Error","data","json","error","console","handleCopyLink","quizId","url","window","location","origin","navigator","clipboard","writeText","then","setTimeout","prev","_objectSpread","undefined","handleDeleteRequest","confirmDelete","method","prevQuizzes","filter","q","_id","alert","cancelDelete","className","children","message","onConfirm","onCancel","to","length","map","quiz","title","Date","createdAt","toLocaleDateString","onClick"],"sources":["C:/Users/chanl/Documents/Kenneth/html/client/src/pages/ProfilePage.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport { Link, useNavigate } from 'react-router-dom';\r\nimport { useAuth } from '../context/AuthContext';\r\nimport ConfirmModal from '../components/ConfirmModal';\r\n\r\nconst ProfilePage = () => {\r\n    const [quizzes, setQuizzes] = useState([]);\r\n    const [quizCount, setQuizCount] = useState(0);\r\n    const [loading, setLoading] = useState(true);\r\n    const [copyStatus, setCopyStatus] = useState({});\r\n    const [showConfirmModal, setShowConfirmModal] = useState(false);\r\n    const [quizToDelete, setQuizToDelete] = useState(null);\r\n    const { token } = useAuth();\r\n    const navigate = useNavigate();\r\n\r\n    useEffect(() => {\r\n        const fetchQuizzes = async () => {\r\n            try {\r\n                const response = await fetch(`${process.env.REACT_APP_API_URL}/api/quiz/my-quizzes`, {\r\n                    headers: { 'x-auth-token': token }\r\n                });\r\n                if (!response.ok) throw new Error('Failed to fetch quizzes');\r\n                const data = await response.json();\r\n                setQuizzes(data.quizzes);\r\n                setQuizCount(data.quizCount);\r\n            } catch (error) {\r\n                console.error(error);\r\n            } finally {\r\n                setLoading(false);\r\n            }\r\n        };\r\n\r\n        if (token) {\r\n            fetchQuizzes();\r\n        }\r\n    }, [token]);\r\n\r\n    const handleCopyLink = (quizId) => {\r\n        const url = `${window.location.origin}/quiz/${quizId}`;\r\n        navigator.clipboard.writeText(url).then(() => {\r\n            setCopyStatus({ [quizId]: 'Copied!' });\r\n            setTimeout(() => setCopyStatus(prev => ({ ...prev, [quizId]: undefined })), 2000);\r\n        });\r\n    };\r\n\r\n    const handleDeleteRequest = (quizId) => {\r\n        setQuizToDelete(quizId);\r\n        setShowConfirmModal(true);\r\n    };\r\n\r\n    const confirmDelete = async () => {\r\n        if (!quizToDelete) return;\r\n        try {\r\n            const response = await fetch(`${process.env.REACT_APP_API_URL}/api/quiz/${quizToDelete}`, {\r\n                method: 'DELETE',\r\n                headers: { 'x-auth-token': token }\r\n            });\r\n            if (!response.ok) throw new Error('Failed to delete quiz');\r\n            // Refresh the list of quizzes\r\n            setQuizzes(prevQuizzes => prevQuizzes.filter(q => q._id !== quizToDelete));\r\n        } catch (error) {\r\n            console.error(error);\r\n            alert('Could not delete the quiz. Please try again.');\r\n        } finally {\r\n            setShowConfirmModal(false);\r\n            setQuizToDelete(null);\r\n        }\r\n    };\r\n\r\n    const cancelDelete = () => {\r\n        setShowConfirmModal(false);\r\n        setQuizToDelete(null);\r\n    };\r\n\r\n    if (loading) {\r\n        return <div className=\"main-wrapper\"><div className=\"card\"><h1>Loading Your Quizzes...</h1></div></div>;\r\n    }\r\n\r\n    return (\r\n        <div className=\"main-wrapper\">\r\n            <div className=\"card\">\r\n                {showConfirmModal && (\r\n                    <ConfirmModal\r\n                        message=\"This quiz will be permanently deleted. This action cannot be undone.\"\r\n                        onConfirm={confirmDelete}\r\n                        onCancel={cancelDelete}\r\n                    />\r\n                )}\r\n                <div className=\"profile-header\">\r\n                    <h1>My Quizzes</h1>\r\n                    <div className=\"profile-actions-group\">\r\n                        <Link to=\"/create\" className=\"primary-button\">Create New Quiz</Link>\r\n                        <span className=\"quiz-counter\">{quizCount} / 3</span>\r\n                    </div>\r\n                </div>\r\n                {quizzes.length > 0 ? (\r\n                    <ul className=\"quiz-list\">\r\n                        {quizzes.map(quiz => (\r\n                            <li key={quiz._id} className=\"quiz-list-item\">\r\n                                <div className=\"quiz-info\">\r\n                                    <Link to={`/quiz/${quiz.quizId}`}>{quiz.title}</Link>\r\n                                    <span className=\"quiz-date\">Created on: {new Date(quiz.createdAt).toLocaleDateString()}</span>\r\n                                </div>\r\n                                <div className=\"quiz-actions\">\r\n                                    <button onClick={() => handleCopyLink(quiz.quizId)} className=\"action-btn copy-btn\" title=\"Copy Link\">{copyStatus[quiz.quizId] || 'Copy'}</button>\r\n                                    <button onClick={() => navigate(`/edit/${quiz._id}`)} className=\"action-btn edit-btn\" title=\"Edit Quiz\">Edit</button>\r\n                                    <button onClick={() => handleDeleteRequest(quiz._id)} className=\"action-btn delete-btn\" title=\"Delete Quiz\">Delete</button>\r\n                                </div>\r\n                            </li>\r\n                        ))}\r\n                    </ul>\r\n                ) : (\r\n                    <p className=\"no-quizzes-message\">You haven't created any quizzes yet.</p>\r\n                )}\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default ProfilePage;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}